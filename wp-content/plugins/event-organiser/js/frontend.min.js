"undefined"==typeof EO_SCRIPT_DEBUG&&(EO_SCRIPT_DEBUG=!0);var eventorganiser=eventorganiser||{};function eveorg_getParameterByName(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}!function(e){jQuery(document).ready(function(){function t(e,t,a){var o;for(o in e)if(e[t]==a)return o;return!1}function a(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var o=t[a].split("=");if(o[0]==e)return o[1]}}function o(a){var o,n=!(void 0===a.whitelist||!a.whitelist)&&a.whitelist.split(","),i="<select class='eo-fc-filter eo-fc-filter-"+a.type+"' data-filter-type='"+a.type+"'>";i+="<option value=''>"+a.select_none+"</option>";for(var r in a.terms){if(o=a.terms[r],n){var s=!1;-1!==e.inArray(o.slug,n)&&(s=!0);for(var l=o;!s&&l.parent>0;)l=t(a.terms,"term_id",l.parent),-1!==e.inArray(l.slug,n)&&(s=!0);if(!s)continue}i+="<option value='"+o.slug+"'>"+o.name+"</option>"}i+="</select>";var d=e("<span class='fc-header-dropdown filter-"+a.type+"'></span>");return d.append(i),d}function n(t){var a,o=void 0!==t.whitelist&&t.whitelist.length>0&&t.whitelist,n="<select class='eo-fc-filter eo-fc-filter-organiser' data-filter-type='organiser'>";n+="<option value=''>"+t.select_none+"</option>";for(var i in t.users)a=t.users[i],o&&-1==e.inArray(parseInt(i,10),o)||(n+="<option value='"+i+"'>"+a+"</option>");n+="</select>";var r=e("<span class='fc-header-dropdown filter-organiser'></span>");return r.append(n),r}function i(){return e("<span class='fc-header-goto'><input type='hidden' class='eo-mini-calendar'/></span>")}if(e(".eo-fullcalendar").on("change",".eo-fc-filter",function(){e(".eo-fullcalendar").fullCalendar("rerenderEvents")}),e(".eo-fullcalendar").length>0){var r,s,l=eventorganiser.calendars;s={agendaDay:"listDay",basicDay:"listDay",listDay:"listDay",agendaWeek:"listWeek",basicWeek:"listWeek",listWeek:"listWeek",month:"listMonth",listMonth:"listMonth"};for(var d=0;d<l.length;d++){var p="#eo_fullcalendar_"+(d+1);void 0===l[d].category&&(l[d].category=""),void 0===l[d].venue&&(l[d].venue="");var c={id:p,defaultDate:l[d].defaultdate?l[d].defaultdate:void 0,category:l[d].event_category,venue:l[d].event_venue,tag:l[d].event_tag,organiser:l[d].event_organiser,event_series:l[d].event_series,customButtons:{category:function(){return o({terms:eventorganiser.fullcal.categories,select_none:EOAjaxFront.locale.cat,whitelist:l[d].event_category,type:"category"})},venue:function(){return o({terms:eventorganiser.fullcal.venues,select_none:EOAjaxFront.locale.venue,whitelist:l[d].event_venue,type:"venue"})},tag:function(){return o({terms:eventorganiser.fullcal.tags,select_none:EOAjaxFront.locale.tag,whitelist:"",type:"tag"})},organiser:function(){return n({users:eventorganiser.fullcal.users,select_none:EOAjaxFront.locale.view_all_organisers,whitelist:l[d].event_organiser})},goto:i},theme:l[d].theme,isRTL:l[d].isrtl,editable:!1,selectable:!1,weekMode:"variable",tooltip:l[d].tooltip,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),weekends:l[d].weekends,hiddenDays:l[d].hiddendays,slotDuration:l[d].slotduration,allDaySlot:l[d].alldayslot,allDayText:l[d].alldaytext,axisFormat:l[d].axisformat,minTime:l[d].mintime,maxTime:l[d].maxtime,weekNumbers:l[d].weeknumbers,weekNumbersWithinDays:l[d].weeknumberswithindays,eventColor:"#1e8cbe",timeFormatphp:l[d].timeformatphp,timeFormat:l[d].timeformat,columnFormat:{month:l[d].columnformatmonth,week:l[d].columnformatweek,day:l[d].columnformatday},titleFormat:{month:l[d].titleformatmonth,week:l[d].titleformatweek,day:l[d].titleformatday},header:{left:l[d].headerleft,center:l[d].headercenter,right:l[d].headerright},eventRender:function(t,a,o){var n=e(o.calendar.options.id).find(".eo-fc-filter-category").val(),i=e(o.calendar.options.id).find(".eo-fc-filter-venue").val(),r=e(o.calendar.options.id).find(".eo-fc-filter-tag").val(),s=e(o.calendar.options.id).find(".eo-fc-filter-organiser").val(),l=!0;if(void 0!==n&&""!==n&&e.inArray(n,t.category)<0&&(l=!1),void 0!==i&&""!==i&&i!==t.venue_slug&&(l=!1),void 0!==r&&""!==r&&e.inArray(r,t.tags)<0&&(l=!1),void 0!==s&&""!==s&&parseInt(s,10)!==t.organiser&&(l=!1),!(l=wp.hooks.applyFilters("eventorganiser.fullcalendar_render_event",l,t,a,o)))return!1;o.calendar.options.tooltip&&e(a).qtip({content:{text:t.description,button:!1,title:t.title},position:{my:"top center",at:"bottom center",viewport:e(window),adjust:{method:"shift none"}},hide:{fixed:!0,delay:500,effect:function(t){e(this).fadeOut("50")}},border:{radius:4,width:3},style:{classes:"eo-event-toolip qtip-eo",tip:"topMiddle"}})},buttonText:{today:EOAjaxFront.locale.today,month:EOAjaxFront.locale.month,week:EOAjaxFront.locale.week,day:EOAjaxFront.locale.day},monthNames:EOAjaxFront.locale.monthNames,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNames:EOAjaxFront.locale.dayNames,dayNamesShort:EOAjaxFront.locale.dayAbbrev,height:!l[d].aspectratio&&"auto",aspectRatio:!!l[d].aspectratio&&l[d].aspectratio,responsive:l[d].responsive,responsiveBreakpoint:l[d].responsivebreakpoint,defaultView:e(window).width()<l[d].responsivebreakpoint&&l[d].responsive?s[l[d].defaultview]:l[d].defaultview,previousView:l[d].defaultview,nextDayThreshold:l[d].nextdaythreshold,windowResize:function(t){t.calendar.options.responsive&&e(window).width()<t.calendar.options.responsiveBreakpoint?e(this).fullCalendar("changeView",s[t.calendar.options.previousView]):e(this).fullCalendar("changeView",t.calendar.options.previousView)},lazyFetching:"true",events:function(t,o,n,i){var r=this.options,s={start:t.format("YYYY-MM-DD"),end:o.format("YYYY-MM-DD"),timeformat:r.timeFormatphp,users_events:0};void 0!==r.category&&""!==r.category&&(s.category=r.category),void 0!==r.venue&&""!==r.venue&&(s.venue=r.venue),void 0!==r.tag&&""!==r.tag&&(s.tag=r.tag),void 0!==r.organiser&&0!==r.organiser&&(s.organiser=r.organiser),r.event_series&&(s.event_series=r.event_series),(s=wp.hooks.applyFilters("eventorganiser.fullcalendar_request",s,t,o,n,r)).search_term=a("search_term"),e.ajax({url:eventorganiser.ajaxurl+"?action=eventorganiser-fullcal",dataType:"JSON",data:s,complete:function(e,t){EO_SCRIPT_DEBUG&&("error"==t||"parsererror"==t&&(window.console&&(console.log("Response is not valid JSON. This is usually caused by error notices from WordPress or other plug-ins"),console.log("Response reads: "+e.responseText)),alert("An error has occurred in parsing the response. Please inspect console log for details")))},success:i})},loading:function(t){var a=e("#"+e(this).attr("id")+"_loading");t?(window.clearTimeout(r),r=window.setTimeout(function(){a.show()},1e3)):(window.clearTimeout(r),a.hide())}};c=wp.hooks.applyFilters("eventorganiser.fullcalendar_options",c,l[d]),e(p).fullCalendar(c)}}void 0!==eventorganiser.fullcal&&e(".eo-mini-calendar").datepicker({dateFormat:"DD, d MM, yy",changeMonth:!0,changeYear:!0,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),buttonText:EOAjaxFront.locale.gotodate,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNamesMin:EOAjaxFront.locale.dayAbbrev,nextText:EOAjaxFront.locale.nextText,prevText:EOAjaxFront.locale.prevText,showOn:"button",beforeShow:function(t,a){a.hasOwnProperty("dpDiv")?a.dpDiv.addClass("eo-datepicker eo-fc-mini-calendar eo-fc-datepicker"):e("#ui-datepicker-div").addClass("eo-datepicker eo-fc-mini-calendar eo-fc-datepicker")},onSelect:function(t,a){var o=e(this).parents("div.eo-fullcalendar").attr("id");e("#"+o).fullCalendar("gotoDate",new Date(Date.parse(t)))}}),e("#eo-upcoming-dates, .eo-upcoming-dates").each(function(t,a){var o={el:e(this)};if(o.el.find("li:gt(4)").length>0){var n={more:EOAjaxFront.locale.ShowMore,less:EOAjaxFront.locale.ShowLess};o.less=e('<a class="eo-upcoming-dates-show-less" href="#"></a>').text(n.less),o.pipe=e('<span class="eo-upcoming-dates-pipe">|</span>'),o.more=e('<a class="eo-upcoming-dates-show-more" href="#"></a>').text(n.more),o.el.find("li:gt(4)").hide().end().after(o.less,o.pipe,o.more),o.pipe.hide(),o.less.hide().click(function(e){e.preventDefault();var t=5*Math.floor((o.el.find("li:visible").length-1)/5)-1;o.el.find("li:gt("+t+")").hide(),o.more.show(),o.pipe.show(),o.el.find("li:visible").length<=5&&(o.less.hide(),o.pipe.hide())}),o.more.click(function(t){t.preventDefault(),o.less.show(),o.pipe.show(),o.el.find("li:hidden:lt(5)").show();var a=o.pipe.offset();e("html, body").animate({scrollTop:Math.max(a.top+40-e(window).height(),e(window).scrollTop())}),0===o.el.find("li:hidden").length&&(o.more.hide(),o.pipe.hide())})}}),e(".eo-widget-cal-wrap").length>0&&e(".eo-widget-cal-wrap").on("click","tfoot a",function(t){if(t.preventDefault(),!e(this).data("eo-widget-cal-disabled")){var a=e(this).closest(".eo-widget-cal-wrap"),o=a.data("eo-widget-cal-id");a.find("tfoot a").data("eo-widget-cal-disabled",1);var n={showpastevents:1,"show-long":0,"link-to-single":0};void 0!==eventorganiser.widget_calendars&&void 0!==eventorganiser.widget_calendars[o]&&(n=eventorganiser.widget_calendars[o]),"undefined"!=typeof eo_widget_cal&&void 0!==eo_widget_cal[o]&&(n=eo_widget_cal[o]),n.eo_month=eveorg_getParameterByName("eo_month",e(this).attr("href")),a.addClass("eo-widget-cal-loading"),e("#"+o+"_overlay").remove(),e("#"+o+"_content").prepend('<div class="eo-widget-cal-overlay" id="'+o+'_overlay"><div class="eo-widget-cal-spinner"/></div>'),e.getJSON(eventorganiser.add_query_arg("action","eo_widget_cal",EOAjaxFront.adminajax),n,function(t){e("#"+o+"_content").html(t),a.removeClass("eo-widget-cal-loading")})}})}),eventorganiser.add_query_arg=function(e,t,a){var o=new RegExp("([?&])"+e+"=.*?(&|$)","i"),n=-1!==a.indexOf("?")?"&":"?";return a.match(o)?a.replace(o,"$1"+e+"="+t+"$2"):a+n+e+"="+t},eventorganiser.template=function(t,a,o){var n=/\\|'|\r|\n|\t|\u2028|\u2029/g;o=void 0!==o?o:{},o=e.extend(!0,{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},o);var i,r={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},s=new RegExp([o.escape.source,o.interpolate.source,o.evaluate.source].join("|")+"|$","g"),l=0,d="__p+='";t.replace(s,function(e,a,o,i,s){return d+=t.slice(l,s).replace(n,function(e){return"\\"+r[e]}),a&&(d+="'+\n((__t=("+a+"))==null?'':_.escape(__t))+\n'"),o&&(d+="'+\n((__t=("+o+"))==null?'':__t)+\n'"),i&&(d+="';\n"+i+"\n__p+='"),l=s+e.length,e}),d+="';\n",o.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+d+"return __p;\n";try{i=new Function(o.variable||"obj","_",d)}catch(e){throw e.source=d,e}if(a)return i(a);return function(e){return i.call(this,e)}},eventorganiser.agenda_widget=function(t){this.param=t,moment.locale(EOAjaxFront.locale.locale,{months:EOAjaxFront.locale.monthNames,monthsShort:EOAjaxFront.locale.monthAbbrev,weekdays:EOAjaxFront.locale.dayNames,weekdaysShort:EOAjaxFront.locale.dayAbbrev,weekdaysMin:EOAjaxFront.locale.dayInitial}),this.start=moment().add(-1,"days"),this.end=moment().add(-1,"days"),this.$el=e("#"+this.param.id+"_container"),this.direction=1,this.eventTemplate=eventorganiser.template(e("#eo-tmpl-agenda-widget-item").html(),null,{variable:"event"}),this.groupTemplate=eventorganiser.template(e("#eo-tmpl-agenda-widget-group").html(),null,{variable:"group"})},eventorganiser.agenda_widget.prototype.group_change=function(e,t){return!1===e||"day"===this.param.mode&&e.format("YYYY-MM-DD")!==t.format("YYYY-MM-DD")},eventorganiser.agenda_widget.prototype.init=function(){this.$el.html(eventorganiser.template(e("#eo-tmpl-agenda-widget").html(),{},{variable:"data"})),this.$datesEl=this.$el.find(".dates"),this.load_events(),this.param.add_to_google&&this.$el.on("click",".event",function(){e(this).find(".meta").toggle("400")});var t=this;this.$el.on("click",".eo-agenda-widget-nav-prev,.eo-agenda-widget-nav-next",function(){e(this).hasClass("eo-agenda-widget-nav-prev")?t.direction=-1:t.direction=1,t.load_events()})},eventorganiser.agenda_widget.prototype.load_events=function(){var t=this;e.ajax({url:EOAjaxFront.adminajax,dataType:"JSON",data:{action:"eo_widget_agenda",instance_number:this.param.number,direction:this.direction,start:this.start.format("YYYY-MM-DD"),end:this.end.format("YYYY-MM-DD")},success:function(e){var a=e.length;if(0!==a){for(var o=0;o<a;o++)e[o].start=moment(e[o].start),e[o].end=moment(e[o].end);t.start=e[0].start,t.end=e[a-1].start,t.insert_events(e)}}})},eventorganiser.agenda_widget.prototype.insert_events=function(t){this.$datesEl.html("");for(var a=t.length,o=!1,n=!1,i=!1,r=0;r<a;r++){if(this.group_change(o,t[r].start)){this.$datesEl.append(n);var s={start:t[r].start};i=(n=e(this.groupTemplate(s))).find(".a-date")}i.append(this.eventTemplate(t[r])),o=t[r].start}this.$datesEl.append(n)},jQuery(document).ready(function(e){if(e(".eo-agenda-widget").length>0)for(var t in eo_widget_agenda)agendaWidget=new eventorganiser.agenda_widget(eo_widget_agenda[t]),agendaWidget.init()})}(jQuery),eventorganiser.google_map=function(e){this.param=e,this.markers={},this.map=null},eventorganiser.google_map.prototype.load=function(){var e={zoom:this.param.zoom,scrollwheel:this.param.scrollwheel,zoomControl:this.param.zoomcontrol,rotateControl:this.param.rotatecontrol,panControl:this.param.pancontrol,overviewMapControl:this.param.overviewmapcontrol,streetViewControl:this.param.streetviewcontrol,draggable:this.param.draggable,mapTypeControl:this.param.maptypecontrol,mapTypeId:google.maps.MapTypeId[this.param.maptypeid],styles:this.param.styles,minZoom:this.param.minzoom,maxZoom:this.param.maxzoom};e=wp.hooks.applyFilters("eventorganiser.google_map_options",e,this.param),this.map=new google.maps.Map(document.getElementById(this.param.id),e);for(var t=new google.maps.LatLngBounds,a=[],o=0;o<this.param.locations.length;o++){var n=this.param.locations[o].lat,i=this.param.locations[o].lng;if(void 0!==n&&void 0!==i){a.push(new google.maps.LatLng(n,i)),t.extend(a[o]);var r=wp.hooks.applyFilters("eventorganiser.venue_marker_options",{venue_id:this.param.locations[o].venue_id,position:a[o],map:this.map,content:this.param.locations[o].tooltipContent,icon:this.param.locations[o].icon}),s=new google.maps.Marker(r);this.markers[this.param.locations[o].venue_id]=s,this.param.tooltip&&google.maps.event.addListener(s,"click",this.tooltip)}}this.param.locations.length>1?this.map.fitBounds(t):this.map.setCenter(a[0]),wp.hooks.doAction("eventorganiser.google_map_loaded",this)},eventorganiser.google_map.prototype.tooltip=function(){var e=this.getMap(),t=this.getMap().getProjection().fromLatLngToPoint(this.position),a=e.getProjection().fromLatLngToPoint(e.getBounds().getNorthEast()),o=e.getProjection().fromLatLngToPoint(e.getBounds().getSouthWest()),n=Math.pow(2,e.getZoom());t=new google.maps.Point((t.x-o.x)*n,(t.y-a.y)*n),wp.hooks.doAction("eventorganiser.venue_marker_clicked",this);var i=[t.x,t.y];if(this.tooltip)return this.tooltip.qtip("api").set("position.target",i),void this.tooltip.qtip("show");this.tooltip=jQuery("<div />").qtip({content:{text:this.content},border:{radius:4,width:3},style:{classes:"qtip-eo ui-tooltip-shadow",widget:!0},position:{at:"right center",my:"top center",target:i,viewport:!0,container:jQuery(this.getMap().getDiv())},show:{ready:!0,event:!1,solo:!0},hide:{event:"mouseleave unfocus"}})},jQuery(document).ready(function(){if("map"in eventorganiser)for(var e=eventorganiser.map,t=0;t<e.length;t++)if(null!==document.getElementById("eo_venue_map-"+(t+1))){var a=e[t];a.id="eo_venue_map-"+(t+1);var o=new eventorganiser.google_map(a);o.load(),eventorganiser.map[t].markers=o.markers}});